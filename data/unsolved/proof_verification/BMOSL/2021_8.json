{
    "metadata": {
        "category": [],
        "competition": "bmo",
        "difficulty": 7.09,
        "level": "high_school",
        "source": "Balkan MO Shortlist",
        "url": "https://www.imo-official.org/",
        "year": 2021
    },
    "problem": "A natural number \\( n \\) is given. Determine all \\((n-1)\\)-tuples of nonnegative integers \\( a_{1}, a_{2}, \\ldots, a_{n-1} \\) such that\n\n\\[\n\\left\\lfloor\\frac{m}{2^{n}-1}\\right\\rfloor+\\left\\lfloor\\frac{2 m+a_{1}}{2^{n}-1}\\right\\rfloor+\\left\\lfloor\\frac{2^{2} m+a_{2}}{2^{n}-1}\\right\\rfloor+\\left\\lfloor\\frac{2^{3} m+a_{3}}{2^{n}-1}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{2^{n-1} m+a_{n-1}}{2^{n}-1}\\right\\rfloor=m\n\\]\nholds for all \\( m \\in \\mathbb{Z} \\).",
    "problem_id": "BMOSL_2021_8",
    "solutions": [
        {
            "author": "Human",
            "solution": "Solution 1. We will show that there is a unique such $n$-tuple: $a_{k}=2^{n-1}+2^{k-1}-1$ for $k=1, \\ldots, n-1$.\nWrite $N=2^{n}-1$ and $f_{k}(x)=\\left[\\frac{2^{k} x+a_{k}}{N}\\right]$ for $k=0,1, \\ldots, n-1$, where $a_{0}=0$. Since\n\n$$\n\\sum_{k=0}^{n-1} f_{k}(m)-\\sum_{k=0}^{n-1} f_{k}(m-1)=1\n$$\nfor each $m \\in \\mathbb{Z}$, there is exactly one $k$ for which $f_{k}(m)=f_{k}(m-1)+1$. We work modulo $N$. The last equality holds if and only if $2^{k} m+a_{k} \\in\\left\\{0,1, \\ldots, 2^{k}-1\\right\\}$. I.e. if and only if\n$$\n2^{k} m \\in\\left\\{-a_{k}, 1-a_{k}, \\ldots, 2^{k}-1-a_{k}\\right\\}\n$$\n\nMultiplying with $2^{n-k}$, and noting that $2^{n} \\equiv 1 \\bmod N$, we get the following:\nFor each $m \\in \\mathbb{Z}$ there is a unique $k \\in\\{0,1, \\ldots, n-1\\}$ such that $m \\in B_{k}$ (modulo $N$ ) where\n\n$$\nB_{k}=\\left\\{b_{k}, b_{k}+2^{n-k}, \\ldots, b_{k}+\\left(2^{k}-1\\right) 2^{n-k}\\right\\}\n$$\nwith $b_{k}=-2^{n-k} a_{k}$. Therefore the problem condition is equivalent to $\\bigcup_{k=0}^{n-1} B_{k}$ being a partition of $\\{0,1, \\ldots, N-1\\}$.\n\nFor a number $b$ and set a $A \\subseteq \\mathbb{Z}$ we write $b+A=\\{b+a: a \\in A\\}$. With this notation, $B_{n-1}=b_{n-1}+\\left\\{0,2,4, \\ldots, 2^{n}-2\\right\\}$. The set $B_{n-2}=b_{n-2}+\\left\\{0,4,8, \\ldots, 2^{n}-4\\right\\}$ is contained in $\\overline{B_{n-1}}=b_{n-1}+\\left\\{1,3, \\ldots, 2^{n}-3\\right\\}$, implying $b_{n-2}, b_{n-2}+2^{n}-4 \\in \\overline{B_{n-1}}$, which holds only if $b_{n-2} \\equiv$ $b_{n-1}+1$. Further, the set $B_{n-3}=b_{n-3}+\\left\\{0,8,16, \\ldots, 2^{n}-8\\right\\}$ is contained in $\\overline{B_{n-1} \\cup B_{n-2}}=$ $b_{n-1}+\\left\\{3,7, \\ldots, 2^{n}-5\\right\\}$, so we must have $b_{n-3} \\equiv b_{n-1}+3$. Similarly, $b_{n-4} \\equiv b_{n-1}+7$ etc. In general, $b_{n-k} \\equiv b_{n-1}+2^{k-1}-1$ for $k=1, \\ldots, n-1$. It follows that $b_{0} \\equiv b_{n-1}+2^{n-1}-1$. On the other hand, we have $b_{0}=0$, which gives $b_{n-1} \\equiv 1-2^{n-1}$ and therefore $b_{k} \\equiv 2^{n-1-k}-2^{n-1}$. Thus $a_{k} \\equiv-2^{k} b_{k} \\equiv 2^{n+k-1}-2^{n-1} \\equiv 2^{n-1}+2^{k-1}-1$ for $k=1, \\ldots, n-1$.\nFinally, $\\sum_{k} f_{k}(0)=0$ implies $a_{k}<N$ for all $k$, so we conclude that $a_{k}=2^{n-1}+2^{k-1}-1$ for each $k=1,2, \\ldots, n-1$.\n\nSolution 2. We will use the identity\n\n$$\n[x]+\\left[x+\\frac{1}{N}\\right]+\\left[x+\\frac{2}{N}\\right]+\\cdots+\\left[x+\\frac{N-1}{N}\\right]=[N x]\n$$\nwhich holds for every $x \\in \\mathbb{R}$ and every $N \\in \\mathbb{N}$. (One can check this by noting that the difference between the two sides of the identity is periodic with period $1 / N$ and that the identity clearly holds for $x \\in\\left[0, \\frac{1}{N}\\right)$. )\nWriting $a_{0}=0$ and $N=2^{n}-1$ we observe that\n$$\nm=\\sum_{k=0}^{n-1}\\left[\\frac{2^{k} m+a_{k}}{N}\\right]=\\sum_{r=0}^{2^{k}-1} \\sum_{r=0}^{2^{k}-1}\\left[\\frac{m+\\frac{a_{k}}{2^{k}}}{N}+\\frac{r}{2^{k}}\\right]=\\sum_{k=0}^{n-1} \\sum_{r=0}^{2^{k}-1}\\left[\\frac{m+\\frac{a_{k}+r N}{2^{k}}}{N}\\right]\n$$\n\nIt follows that $c_{r, k}=\\left[\\frac{a_{k}+r N}{2^{k}}\\right]$ are all distinct modulo $N$ for $k=0,1, \\ldots, n-1$ and $r=$ $0,1, \\ldots, 2^{k}-1$. Indeed if two (or more) of them are congruent to $t$, then writing $f(t)$ for the right hand side of $(1)$ we get $1=f(-t)-f(-t-1) \\geqslant 2$, a contradiction.\n\nSince $N=2^{n}-1$, then $c_{r, k}=r 2^{n-k}+d_{r, k}$, where $d_{r, k}=\\left[\\frac{a_{k}-r}{2^{k}}\\right]$. Because $c_{0,0}=0$, then $c_{0, k} \\neq 0$ for each $k \\neq 0$ giving $a_{k} \\geqslant 2^{k}$ for each $k \\geqslant 1$. Setting $m=0$ in the original equation gives $a_{k}<N$ for each $k$ and so $d_{0, k} \\leqslant 2^{n-k}-1$ for each $k$. Furthermore\n\n$$\n2^{n-k}-1 \\geqslant d_{0, k} \\geqslant d_{1, k} \\geqslant \\cdots \\geqslant d_{2^{k}-1, k} \\geqslant d_{2^{k}, k}=d_{0, k}-1 \\geqslant 0\n$$\n\nIn particular $0 \\leqslant c_{r, k}=r 2^{n-k}+d_{r, k} \\leqslant\\left(2^{n}-2^{n-k}\\right)+\\left(2^{n-k}-1\\right)=N$. For $k=0,1,2, \\ldots, n-1$ define $A_{k}=\\left\\{c_{r, k}: r=0,1, \\ldots, 2^{k}-1\\right\\}$. From the above, since $A_{0}=\\{0\\}$, we must have that $A_{1} \\cup A_{2} \\cup \\cdots \\cup A_{n-1}=\\{1,2, \\ldots, N-1\\}$.\n\nFor a natural number $t$ let $v_{2}(t)$ be as usual the largest exponent such that $2^{v_{2}(t)} \\mid t$. Let\n\n$$\nf(t)=n-v_{2}(t)-1, \\quad g(t)=\\frac{t-2^{v_{2}(t)}}{2^{1+v_{2}(t)}}, \\quad \\text { and } \\quad h(t)=2^{f(t)}-1-g(t)\n$$\n\nNote that $f(t)$ uniquely determines $v_{2}(t)$ and together with $g(t)$ they uniquely determine $t$. Similarly $h(t)$ and $g(t)$ uniquely determine $t$.\nClaim. For each $t \\in\\left\\{1,2, \\ldots, 2^{n-1}-1\\right\\}$ we have:\n(i) $d_{g(t), f(t)}=2^{v_{2}(t)}$,\n(ii) $d_{h(t), f(t)}=2^{v_{2}(t)}-1$,\n(iii) $c_{g(t), f(t)}=t$,\n(iv) $c_{h(t), f(t)}=N-t$.\n\nProof of Claim. We proceed by induction on $t$. For $t=1$ we have $v_{2}(1)=0, f(1)=$ $n-1, g(1)=0$ and $h(1)=2^{n-1}-1$. From (2) we have $1 \\geqslant d_{0, n-1}$ and $d_{0, n-1}-1 \\geqslant 0$ proving (i). Also, $c_{g(1), f(1)}=c_{0, n-1}=d_{0, n-1}=1$ proving (iii). From (2) we have $1 \\geqslant d_{2^{n-1}-1, n-1} \\geqslant 0$. But $c_{2^{n-1}-1, n-1}=2^{n}-2+d_{2^{n-1}-1, n-1}=N-1+d_{2^{n-1}-1, n-1}$. Since $c_{2^{n-1}-1, n-1} \\leqslant N-1$ we deduce both (ii) and (iv).\n\nAssume now that the result is true for $t=s-1$. We will prove the result for $t=s$.\nCase 1: If $s-1=2 u$ is even, then $v_{2}(s)=0$, so $f(s)=n-1, g(s)=u$ and $h(s)=2^{n-1}-1-u$.\nBy the induction hypothesis, since all the $c_{r, k}$ 's are distinct, we must have\n\n$$\ns \\leqslant c_{g(s), f(s)}=2 u+d_{g(s), f(s)}=s-1+d_{g(s), f(s)}\n$$\nand\n$$\nN-s \\geqslant c_{h(s), f(s)}=2^{n}-2-2 u+d_{h(s), f(s)}=N-s+d_{h(s), f(s)}\n$$\n\nFrom the above we must have $d_{g(s), f(s)} \\geqslant 1$ and $d_{h(s), f(s)} \\leqslant 0$. But from (2) any two $d_{r, k}$ 's for fixed $k$ differ by at most $1$. This can only be achieved if we have equalities everywhere proving (i)-(iv).\n\nCase 2: If $s-1=2 u+1$ is odd, then we write $s=2 u+2=2^{v} w$ for some odd $w$. Then $v_{2}(s)=v$ and so $k=f(s)=n-1-v$ and $r=g(s)=(w-1) / 2$. Also $h(s)=2^{k}-1-r$. By the induction hypothesis we must have\n\n$$\ns \\leqslant c_{r, k}=r 2^{n-k}+d_{r, k}=2^{v}(w-1)+d_{r, k}=s-2^{v}+d_{r, k}\n$$\nand\n\\$\\$\\begin{aligned}\n\nN-s \\geqslant c_{h(s), k} \\& =\\left(2^{k}-1-r\\right) 2^{n-k}+d_{h(s), k} <br>\n\\& =2^{n}-2^{v+1}-s+2^{v}+d_{h(s), k} <br>\n\\& =N+1-s-2^{v}+d_{h(s), k}\n\n\\end{aligned}\\$\\$\n\nFrom the above we must have $d_{r, k} \\geqslant 2^{v}$ and $d_{h(s), k} \\leqslant 2^{v}-1$. As in Case $1$ we must have equalities everywhere proving (i)-(iv).\nFor $t=2^{n-1}-2^{n-k-1}$ we have $v_{2}(t)=n-k-1, f(t)=k, g(t)=2^{k-1}-1$ and $h(t)=$ $2^{k}-1-\\left(2^{k-1}-1\\right)=2^{k-1}$. Thus from (ii) and (iv) we get\n\n$$\n\\left[\\frac{a_{k}-\\left(2^{k-1}-1\\right)}{2^{k}}\\right]=2^{n-k-1} \\quad \\text { and } \\quad\\left[\\frac{a_{k}-2^{k-1}}{2^{k}}\\right]=2^{n-k-1}-1 .\n$$\n\nThis is only possible if $a^{k}=2^{k} \\cdot 2^{n-k-1}+\\left(2^{k-1}-1\\right)=2^{n-1}+2^{k-1}-1$ as required.",
            "images": {}
        }
    ],
    "grading_scheme": [
        {
            "part_id": 1,
            "title": "Correctness",
            "description": "<p>A solution should be considered correct even if it would earn 5+/7 points in a full grading. Examples of small penalties worth 1 point are if the solution: <ul><li>Makes a small computational mistake that can be easily fixed</li><li>Misses an edge case which can be easily proven/disproven</li><li>Skips over a step that follows without much reasoning or manual work</li></ul> A solution should be marked as incorrect if: <ul><li>It marks a step as trivial, if it is not immediately obvious why this would be the case</li><li>It omits algebra-heavy computational steps, regardless of whether or not it has outlined the methodology</li><li>Generalizes over a pattern without rigorously describing the pattern, or without proving any relevant properties.</li><li>It cites a non-existing or unpopular source/Theorem, which cannot be immediately found from searching for it online. Thus, any theorems that can be immediately found and have a Wikipedia article are allowed.</li></ul> The model has been specifically told that it should not skip steps or mark them as trivial. Any violation of this rule should be considered by assuming the model does not know how to derive the &quot;trivial&quot; step</p>",
            "points": 1
        }
    ],
    "points": 1
}