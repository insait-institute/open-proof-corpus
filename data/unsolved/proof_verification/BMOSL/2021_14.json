{
    "metadata": {
        "category": [],
        "competition": "bmo",
        "difficulty": 7.09,
        "level": "high_school",
        "source": "Balkan MO Shortlist",
        "url": "https://www.imo-official.org/",
        "year": 2021
    },
    "problem": "A sequence of \\(2n+1\\) non-negative integers \\(a_1, a_2, \\ldots, a_{2n+1}\\) is given. There's also a sequence of \\(2n+1\\) consecutive cells enumerated from \\(1\\) to \\(2n+1\\) from left to right, such that initially the number \\(a_i\\) is written on the \\(i\\)-th cell, for \\(i=1, 2, \\ldots, 2n+1\\). Starting from this initial position, we repeat the following sequence of steps, as long as it's possible:\n\nStep 1: Add up the numbers written on all the cells, denote the sum as \\(s\\).\nStep 2: If \\(s\\) is equal to \\(0\\) or if it is larger than the current number of cells, the process terminates. Otherwise, remove the \\(s\\)-th cell, and shift all cells that are to the right of it one position to the left. Then go to Step 1.\n\nExample: \\((1,0,1, \\underline{2}, 0) \\rightarrow(1, \\underline{0}, 1,0) \\rightarrow(1, \\underline{1}, 0) \\rightarrow(\\underline{1}, 0) \\rightarrow(0)\\).\n\nA sequence \\(a_1, a_2, \\ldots, a_{2n+1}\\) of non-negative integers is called balanced if at the end of this process there's exactly one cell left, and it's the cell that was initially enumerated by \\(n+1\\), i.e., the cell that was initially in the middle.\n\nFind the total number of balanced sequences as a function of \\(n\\).",
    "problem_id": "BMOSL_2021_14",
    "solutions": [
        {
            "author": "Human",
            "solution": "Solution. The answer is: $C_{n} \\cdot C_{n}$, where $C_{n}=\\frac{1}{n+1}\\binom{2 n}{n}$ is the $n$-th Catalan number.\nWe divide the proof into several steps. First, some terminology: the last (rightmost) $n$ cells will be called the back cells and the front (leftmost) $n$ cells will be called the front cells. The central, $(n+1)$-st, cell will be called the middle cell.\n\nClaim 1. All the back cells must be removed before any front cell is removed.\nProof. Assume for contradiction that this is not the case. Then there must be a point in time where a front cell is deleted and then immediately after a back cell is deleted. Let us say that the deleted front cell was at position $i$. So all back cells have positions greater or equal to $i+2$. After the cell is deleted all back cells have positions greater or equal to $i+1$. But since we deleted cell $i$, then the total sum is $i$ and this does not increase. So at the next step we delete a cell at position at most $i$, a contradiction.\n\nClaim 2. The middle cell must contain the number $0$, i.e., $a_{n+1}=0$.\nProof. Consider the last step in the process where we have total of $2$ cells. One of these is the middle cell, and by Claim $1$ the other must be one of the front cells. I.e. we have $\\left(x, a_{n+1}\\right)$. On the next move, we remove $x$, which means that $x+a_{n+1}=1$. So $a_{n+1}=0$ or $a_{n+1}=1$. But after that we cannot remove $a_{n+1}$, which means that $a_{n+1} \\neq 1$. So $a_{n+1}=0$.\n\nNow, let's define a self-destructing sequence to be one with no surviving cells at the end of the process. For example, $(0,1,2)$ is self-destructing because $(0,1,2) \\rightarrow(0,1) \\rightarrow(1) \\rightarrow()$.\nLet $\\mathcal{S}_{n}$ be the set of self-destructing sequences of length $n$. For example, $\\mathcal{S}_{2}=\\{(0,1),(1,1)\\}$. It is clear that the front cells form a self-destructing sequence, i.e., $\\left(a_{1}, a_{2}, \\cdots a_{n}\\right) \\in \\mathcal{S}_{n}$. The back cells also have certain self-destructing quality, which is made more precise in Claim $3$ below.\n\nClaim 3. Fix the front sequence $\\varphi=\\left(a_{1}, a_{2}, \\cdots, a_{n}\\right)$. Let $\\mathcal{B}_{\\phi}$ be the set of all possible back sequences of length $n$ that can be appended to $\\varphi$ (with a $0$ between them) to get a balanced sequence. Then there is a bijection $f: \\mathcal{S}_{n} \\mapsto \\mathcal{B}_{\\phi}$.\n\nProof. Let $c=n+1-\\sum_{i=1}^{n} a_{i}$ and consider a particular $\\sigma=\\left(s_{1}, s_{2}, \\ldots, s_{n}\\right) \\in \\mathcal{S}_{n}$. Let $\\ell$ be the initial index of the last surviving cell in $\\sigma$. Then $f(\\sigma)=\\left(s_{1}, s_{2}, \\ldots, s_{\\ell}+c, s_{\\ell+1}, \\ldots, s_{n}\\right)$ defines a bijection $\\mathcal{S}_{n} \\mapsto \\mathcal{B}_{\\phi}$.\n\nIndeed we claim that the $k$-th deleted cell in $\\sigma$ is the $k$-th deleted cell in $\\overline{\\varphi 0 f(\\sigma)}$ for each $k=1, \\ldots, n$. Indeed after some deletions let $S$ be the total sum remaining in $\\sigma$. Then the total sum remaining in $\\overline{\\varphi 0 f(\\sigma)}$ is $-\\sum_{i=1}^{n} a_{i}+0+S+c=S+n+1$. So we delete next the cell in position $S$ in $\\sigma$ if and only if we delete the cell in position $S+n+1$ in $\\overline{\\varphi 0 f(\\sigma)}$.\nSo $\\overline{\\phi 0 f(\\sigma)}$ is clearly a balanced sequence: we first eliminate all cells in the back, then the front. In the same manner it follows that every balanced sequence in of this form.\n\nSo far we have shown that the total number of balanced sequences is $\\left|\\mathcal{S}_{n}\\right|^{2}$. It remains to calculate the size $\\left|\\mathcal{S}_{n}\\right|$.\n\nClaim 4. Let $\\mathcal{T}_{n}$ be the set of $2 n$-sequences consisting of $n$ zeros and $n$ ones such that in each initial segment the number of 1's does not surpass the number of $0$ 's. Then $\\left|\\mathcal{S}_{n}\\right|=\\left|\\mathcal{T}_{n}\\right|$.\n\nProof. Let $[n]=\\{1,2, \\ldots, n\\}$, and let us also consider the set $\\mathcal{F}_{n}$ of non-decreasing mappings $f:[n] \\rightarrow[n]$ such that $f(i) \\leqslant i$ for each $i \\in[n]$. The claim will follow once we show that $\\left|\\mathcal{S}_{n}\\right|=\\left|\\mathcal{F}_{n}\\right|$ and that $\\left|\\mathcal{F}_{n}\\right|=\\left|\\mathcal{T}_{n}\\right|$.\n\nIn order to demonstrate that $\\left|\\mathcal{S}_{n}\\right|=\\left|\\mathcal{F}_{n}\\right|$, observe that there is an obvious bijective correspondence $a \\mapsto f$ between the sets $\\mathcal{S}_{n}$ and $\\mathcal{F}_{n}$. Indeed, reversing the self-destructing process for an $n$-sequence $a=\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right) \\in \\mathcal{S}_{n}$, simply define $f(i)$ to be the (partial) sum of the existing terms after the $i$-th backward step.\n\nAs for $\\left|\\mathcal{T}_{n}\\right|=\\left|\\mathcal{F}_{n}\\right|$, note the following bijective correspondence $t \\mapsto f$ between the sets $\\mathcal{T}_{n}$ and $\\mathcal{F}_{n}$. Let $f(i)$ equal $1+\\#(i)$, where $\\#(i)$ is defined to be the total number of $1^{\\prime} s$ appearing in $t$ before the $i$-th zero.\n\nFinally, it is a known fact that $\\left|\\mathcal{B}_{n}\\right|$ is the $n$-th Catalan number $C_{n}=\\frac{1}{n+1}\\binom{2 n}{n}$. (The essential idea of the textbook proof of this fact uses the so-called reflection principle of A. D. Andr\u0413\u00a9.)",
            "images": {}
        }
    ],
    "grading_scheme": [
        {
            "part_id": 1,
            "title": "Correctness",
            "description": "<p>A solution should be considered correct even if it would earn 5+/7 points in a full grading. Examples of small penalties worth 1 point are if the solution: <ul><li>Makes a small computational mistake that can be easily fixed</li><li>Misses an edge case which can be easily proven/disproven</li><li>Skips over a step that follows without much reasoning or manual work</li></ul> A solution should be marked as incorrect if: <ul><li>It marks a step as trivial, if it is not immediately obvious why this would be the case</li><li>It omits algebra-heavy computational steps, regardless of whether or not it has outlined the methodology</li><li>Generalizes over a pattern without rigorously describing the pattern, or without proving any relevant properties.</li><li>It cites a non-existing or unpopular source/Theorem, which cannot be immediately found from searching for it online. Thus, any theorems that can be immediately found and have a Wikipedia article are allowed.</li></ul> The model has been specifically told that it should not skip steps or mark them as trivial. Any violation of this rule should be considered by assuming the model does not know how to derive the &quot;trivial&quot; step</p>",
            "points": 1
        }
    ],
    "points": 1
}