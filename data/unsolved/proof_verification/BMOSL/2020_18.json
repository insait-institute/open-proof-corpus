{
    "metadata": {
        "category": [],
        "competition": "bmo",
        "difficulty": 7.05,
        "level": "high_school",
        "source": "Balkan MO Shortlist",
        "url": "Private",
        "year": 2020
    },
    "problem": "Consider an integer \\( n \\geq 2 \\) and an odd prime \\( p \\). Let \\( U \\) be the set of all positive integers strictly less than \\( p^n \\) that are not divisible by \\( p \\), and let \\( N \\) be the number of elements of \\( U \\). Does there exist a permutation \\( a_1, a_2, \\ldots, a_N \\) of the numbers in \\( U \\) such that the sum \\(\\sum_{k=1}^{N} a_k a_{k+1}\\), where \\( a_{N+1}=a_1 \\), is divisible by \\( p^{n-1} \\) but not by \\( p^n \\)?",
    "problem_id": "BMOSL_2020_18",
    "solutions": [
        {
            "author": "Human",
            "solution": "Solution. The answer is in the affirmative. Letting $\\equiv$ denote congruence modulo $p^{n}$ throughout the argument, we will show that there exists a permutation $a_{1}, a_{2}, \\ldots, a_{N}$ of the numbers in $U$ such that $\\sum_{k=1}^{N} a_{k} a_{k+1} \\equiv p^{n-1}$.\n\nLet $m=p^{n-1}-1$, so $N=p^{n-1}(p-1)=(m+1)(p-1)$, and write $U=\\left\\{u_{1}, u_{2}, \\ldots, u_{N}\\right\\}$, where $u_{k}=k+\\lfloor k /(p-1)\\rfloor^{*}, k=1,2, \\ldots, N$, and $\\lfloor t\\rfloor^{*}$ denotes the largest integer (strictly) less than the real number $t$.\n\nThat the $u_{k}$ are pairwise distinct and they all lie in $U$ follows from the fact that every $k$ in the range $1,2, \\ldots, N$ is uniquely expressible in the form $k=(p-1) j+i$ for some $j$ in the range $0,1, \\ldots, m$ and some $i$ in the range $1,2, \\ldots, p-1$. Thus, $u_{k}=u_{(p-1) j+i}=p j+i$, so the $u_{k}$ are indeed pairwise distinct and they all lie in $U$.\n\nFor $k$ in the range $1,2, \\ldots, N-1$, notice that $u_{k+1}-u_{k}=1$, unless $k$ is divisible by $p-1$, in which case $u_{k+1}-u_{k}=2$. Setting $u_{N+1}=u_{1}$, it is readily checked that $u_{N+1}-u_{N}=2-p^{n} \\equiv 2$, so $u_{k+1}-u_{k} \\equiv 2$ for all $k$ divisible by $p-1$.\n\nLetting now $a_{k}$ be the multiplicative inverse of $u_{k}$ modulo $p^{n}$, i. e., $a_{k}$ is the unique member of $U$ satisfying $a_{k} u_{k} \\equiv 1$, we show that the $a_{k}$ form the desired permutation of $U$.\n\nTo begin with, notice that $a_{k} a_{k+1} \\equiv a_{k}-a_{k+1}$, unless $k$ is divisible by $p-1$, in which case $a_{k} a_{k+1} \\equiv \\frac{1}{2}\\left(a_{k}-a_{k+1}\\right)$. This is easily established by multiplying both sides of each congruence by $u_{k} u_{k+1}$, and noticing that $\\left(a_{k}-a_{k+1}\\right) u_{k} u_{k+1} \\equiv u_{k+1}-u_{k} \\equiv 1$ or $2$.\n\nWe are now in a position to evaluate the sum $S=\\sum_{k=1}^{N} a_{k} a_{k+1}$ modulo $p^{n}$. Write\n\n$$\nS=\\sum_{k=1}^{N} a_{k} a_{k+1}=\\sum_{j=0}^{m} \\sum_{i=1}^{p-1} a_{(p-1) j+i} a_{(p-1) j+i+1}\n$$\nand consider the inner sum for a fixed $j$ in the range $0,1, \\ldots, m$ :\n\\$\\$\\begin{aligned}\n\n\\sum_{i=1}^{p-1} a_{(p-1) j+i} a_{(p-1) j+i+1} \\& =\\sum_{i=1}^{p-2} a_{(p-1) j+i} a_{(p-1) j+i+1}+a_{(p-1) j(j+1)} a_{(p-1)(j+1)+1} <br>\n\\& \\equiv \\sum_{i=1}^{p-2}\\left(a_{(p-1) j+i}-a_{(p-1) j+i+1}\\right)+\\frac{1}{2}\\left(a_{(p-1) j(j+1)}-a_{(p-1)(j+1)+1}\\right) <br>\n\\& \\equiv a_{(p-1) j+1}-a_{(p-1)(j+1)}+\\frac{1}{2}\\left(a_{(p-1) j(j+1)}-a_{(p-1)(j+1)+1}\\right) <br>\n\\& \\equiv a_{(p-1) j+1}-\\frac{1}{2} a_{(p-1) j(j+1)}-\\frac{1}{2} a_{(p-1)(j+1)+1}\n\n\\end{aligned}\\$\\$\n\nHence\n\n$$\n\\begin{aligned}\nS & \\equiv \\sum_{j=0}^{m} a_{(p-1) j+1}-\\frac{1}{2} \\sum_{j=0}^{m} a_{(p-1)(j+1)}-\\frac{1}{2} \\sum_{j=0}^{m} a_{(p-1)(j+1)+1} \\\\\n& \\equiv\\left(a_{1}+\\sum_{j=1}^{m} a_{(p-1) j+1}\\right)-\\frac{1}{2} \\sum_{j=1}^{m+1} a_{(p-1) j}-\\frac{1}{2}\\left(\\sum_{j=1}^{m} a_{(p-1) j+1}+a_{N+1}\\right) \\\\\n& \\equiv \\frac{1}{2} \\sum_{j=1}^{m+1} a_{(p-1) j+1}-\\frac{1}{2} \\sum_{j=1}^{m+1} a_{(p-1) j} .\n\\end{aligned}\n$$\n\nSince $u_{(p-1) j+1}=p j+1$, the $a_{(p-1) j+1}$ form a permutation of the $p j+1$, therefore $\\sum_{j=1}^{m+1} a_{(p-1) j+1} \\equiv \\sum_{j=1}^{m+1}(p j+1)$. Similarly, $u_{(p-1) j}=p j-1$, so the $a_{(p-1) j+1}$ form a permutation of the $p j-1$, and hence $\\sum_{j=1}^{m+1} a_{(p-1) j} \\equiv \\sum_{j=1}^{m+1}(p j-1)$. Consequently,\n\n$$\nS \\equiv \\frac{1}{2} \\sum_{j=1}^{m+1}((p j+1)-(p j-1)) \\equiv m+1 \\equiv p^{n-1}\n$$\nas stated in the first paragraph. This completes the solution.\nRemark. Multiplication modulo $p^{n}$ makes $U$ into the group of units of the ring $\\mathbb{Z}_{p^{n}}$. Since $p$ is odd, $U$ is cyclic. Let $g$ be a generator, i. e., a primitive root modulo $p^{n}$. In this setting, the sum in question is $S_{g, \\alpha} \\equiv \\sum_{k=1}^{N} g^{\\alpha_{k}+\\alpha_{k+1}}$, where $\\alpha$ is a permutation of $1,2$, $\\ldots, N$. The solution shows that $S_{g, \\alpha} \\equiv p^{n-1}$ for the permutation given by $a_{k}=g^{\\alpha_{k}}$; for instance, if $n=2, p=5$ and $g=2$, this permutation has disjoint cycle decomposition\n$$\n\\text { (1 } 2010 \\text { 11) (2 } 199418313 \\text { 16) (5 } 121471786 \\text { 15). }\n$$\n\nEvaluating $S_{g, \\alpha}$ is not an easy task, unless $\\alpha$ exhibits particular features. Consider the identity permutation, in which case $S_{g, \\text { id }} \\equiv 2 g^{3} \\sum_{k=0}^{N / 2-1} g^{2 k}$, so $\\left(g^{2}-1\\right) S_{g, \\text { id }} \\equiv$ $2 g^{3}\\left(g^{N}-1\\right) \\equiv 0$. If $p>3$ and $g$ is a primitive root modulo $p$, then $S_{g, \\text { id }} \\equiv 0$, so such a $g$ is not a candidate. In particular, this rules out the standard choice for $g$ modulo $p^{n}$ as a primitive root modulo $p$ such that $g^{p-1}-1$ is not divisible by $p^{2}$. A good candidate for $g\\left(p=3\\right.$, inclusive) would be a primitive root modulo $p^{2}$ such that $g^{2}-1$ is divisible by $p$. In this case, $g^{2}-1$ is divisible by $p$ but not by $p^{2}$, and $g^{N}-1$ is divisible by $p^{n}$ but not by $p^{n+1}$, so $S_{g, \\text { id }}$ satisfies the required condition. This is the case if $p=3$ : The primitive roots modulo $3^{2}$ are $2$ and $5$, and the identity permutation works for both modulo $3^{2}$. Unfortunately, no such $g$ exists if $p=5$ : The primitive roots $g$ modulo $5^{2}$ are $\\pm 2, \\pm 3$ and $\\pm 8$, no $g^{2}-1$ is divisible by $5$, so $S_{g, \\text { id }}$ is divisible by $5^{2}$, showing the identity inadequate modulo $5^{2}$.",
            "images": {}
        }
    ],
    "grading_scheme": [
        {
            "part_id": 1,
            "title": "Correctness",
            "description": "<p>A solution should be considered correct even if it would earn 5+/7 points in a full grading. Examples of small penalties worth 1 point are if the solution: <ul><li>Makes a small computational mistake that can be easily fixed</li><li>Misses an edge case which can be easily proven/disproven</li><li>Skips over a step that follows without much reasoning or manual work</li></ul> A solution should be marked as incorrect if: <ul><li>It marks a step as trivial, if it is not immediately obvious why this would be the case</li><li>It omits algebra-heavy computational steps, regardless of whether or not it has outlined the methodology</li><li>Generalizes over a pattern without rigorously describing the pattern, or without proving any relevant properties.</li><li>It cites a non-existing or unpopular source/Theorem, which cannot be immediately found from searching for it online. Thus, any theorems that can be immediately found and have a Wikipedia article are allowed.</li></ul> The model has been specifically told that it should not skip steps or mark them as trivial. Any violation of this rule should be considered by assuming the model does not know how to derive the &quot;trivial&quot; step</p>",
            "points": 1
        }
    ],
    "points": 1,
    "date_added": "2025-06-02 21:45:56"
}