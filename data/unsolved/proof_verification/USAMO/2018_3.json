{
    "metadata": {
        "category": [],
        "competition": "usamo",
        "difficulty": 7.36,
        "level": "high_school",
        "source": "USAMO",
        "url": "https://web.evanchen.cc/problems.html",
        "year": 2018
    },
    "problem": "Let \\( n \\geq 2 \\) be an integer, and let \\(\\{a_{1}, \\ldots, a_{m}\\}\\) denote the \\( m=\\varphi(n) \\) integers less than \\( n \\) and relatively prime to \\( n \\). Assume that every prime divisor of \\( m \\) also divides \\( n \\). Prove that \\( m \\) divides \\( a_{1}^{k}+\\cdots+a_{m}^{k} \\) for every positive integer \\( k \\).",
    "problem_id": "USAMO_2018_3",
    "solutions": [
        {
            "author": "Human",
            "solution": "For brevity, given any $n$, we let $A(n)=\\{1 \\leq x \\leq n, \\operatorname{gcd}(x, n)=1\\}$ (thus $|A(n)|=\\varphi(n)$ ). Also, let $S(n, k)=\\sum_{a \\in A(n)} a^{k}$.\n\nWe will prove the stronger statement (which eliminates the hypothesis on $n$ ).\nClaim - Let $n \\geq 2$ be arbitrary (and $k \\geq 0$ ). If $p \\mid n$, then\n\n$$\n\\nu_{p}(\\varphi(n)) \\leq \\nu_{p}(S(n, k))\n$$\n\nWe start with the special case where $n$ is a prime power.\n\n## Lemma\n\nLet $p$ be prime, $e \\geq 1, k \\geq 0$. We always have\n\n$$\nS\\left(p^{e}, k\\right)=\\sum_{x \\in A\\left(p^{e}\\right)} x^{k} \\equiv 0 \\quad\\left(\\bmod p^{e-1}\\right) .\n$$\n\nProof. For $p$ odd, this follows by taking a primitive root $g$ modulo $p^{e}$. We will have\n\n$$\nS\\left(p^{e}, k\\right) \\equiv 1+g^{k}+g^{2 k}+\\cdots+g^{\\left(\\varphi\\left(p^{e}\\right)-1\\right) k} \\equiv \\frac{g^{\\varphi\\left(p^{e}\\right) k}-1}{g^{k}-1} .\n$$\n\nIf $p-1 \\nmid k$, then the denominator is not divisible by $p$ and hence the entire expression is $0\\left(\\bmod p^{e}\\right)$. In the other case where $p-1 \\mid k$, since $\\nu_{p}\\left(\\varphi\\left(p^{e}\\right)\\right)=e-1$, the exponent lifting lemma implies\n\n$$\n\\nu_{p}\\left(\\left(g^{k}\\right)^{\\varphi\\left(p^{e}\\right)}-1\\right)=\\nu_{p}\\left(g^{k}-1\\right)+(e-1)\n$$\nand so the conclusion is true here too.\nIn the annoying case $p=2$, the proof is broken into two cases: for $k$ odd it follows by pairing $x$ with $2^{e}-x$ and when $k$ is even one can take $5$ as a generator of all the quadratic residues as in the $p>2$ case.\n\n## Corollary\n\nWe have $\\nu_{p}\\left(1^{k}+\\cdots+t^{k}\\right) \\geq \\nu_{p}(t)-1$ for any $k, t, p$.\n\nProof. Assume $p \\mid t$. Handle the terms in that sum divisible by $p$ (by induction) and apply the lemma a bunch of times.\n\nNow the idea is to add primes $q$ one at a time to $n$, starting from the base case $n=p^{e}$. So, formally we proceed by induction on the number of prime divisors of $n$. We'll also assume $k \\geq 1$ in what follows since the base case $k=0$ is easy.\n\n- First, suppose we want to go from $n$ to $n q$ where $q \\nmid n$. In that case $\\varphi(n q)$ gained $\\nu_{p}(q-1)$ factors of $p$ and then we need to show $\\nu_{p}(S(n q, k)) \\geq \\nu_{p}(\\varphi(n))+\\nu_{p}(q-1)$. The trick is to write\n\n$$\nA(n q)=\\{a+n h \\mid a \\in A(n) \\text { and } h=0, \\ldots, q-1\\} \\backslash q A(n)\n$$\nand then expand using binomial theorem:\n\\$\\$\\begin{aligned}\n\nS(n q, k) \\& =\\sum_{a \\in A(n)} \\sum_{h=0}^{q-1}(a+n h)^{k}-\\sum_{a \\in A(n)}(q a)^{k} <br>\n\\& =-q^{k} S(n, k)+\\sum_{a \\in A(n)} \\sum_{h=0}^{q-1} \\sum_{j=0}^{k}\\left[\\binom{k}{j} a^{k-j} n^{j} h^{j}\\right] <br>\n\\& =-q^{k} S(n, k)+\\sum_{j=0}^{k}\\left[\\binom{k}{j} n^{j}\\left(\\sum_{a \\in A(n)} a^{k-j}\\right)\\left(\\sum_{h=0}^{q-1} h^{j}\\right)\\right] <br>\n\\& =-q^{k} S(n, k)+\\sum_{j=1}^{k}\\left[\\binom{k}{j} n^{j} S(n, k-j)\\left(\\sum_{h=1}^{q-1} h^{j}\\right)\\right] .\n\n\\end{aligned}\\$\\$\n\nWe claim every term here has enough powers of $p$. For the first term, $S(n, k)$ has at least $\\nu_{p}(\\varphi(n))$ factors of $p$; and we have the $q-q^{k}$ multiplier out there. For the other terms, we apply induction to $S(n, k-j)$; moreover $\\sum_{h=1}^{q-1} h^{j}$ has at least $\\nu_{p}(q-1)-1$ factors of $p$ by corollary, and we get one more factor of $p$ (at least) from $n^{j}$.\n\n- On the other hand, if $q$ already divides $n$, then this time\n\n$$\nA(n q)=\\{a+n h \\mid a \\in A(n) \\text { and } h=0, \\ldots, q-1\\} .\n$$\nand we have no additional burden of $p$ to deal with; the same calculation gives\n$$\nS(n q, k)=q S(n, k)+\\sum_{j=1}^{k}\\left[\\binom{k}{j} n^{j} S(n, k-j)\\left(\\sum_{h=1}^{q-1} h^{j}\\right)\\right]\n$$\n\nwhich certainly has enough factors of $p$ already.\n\nRemark. A curious bit about the problem is that $\\nu_{p}(\\varphi(n))$ can exceed $\\nu_{p}(n)$, and so it is not true that the residues of $A(n)$ are well-behaved modulo $\\varphi(n)$.\n\nAs an example, let $n=2 \\cdot 3 \\cdot 7 \\cdot 13=546$, so $m=\\varphi(n)=1 \\cdot 2 \\cdot 6 \\cdot 12=144$. Then $A(n)$ contains $26$ elements which are $1 \\bmod 9$ and $23$ elements which are $4 \\bmod 9$.\n\nRemark. The converse of the problem is true too (but asking both parts would make this too long for exam).",
            "images": {}
        }
    ],
    "grading_scheme": [
        {
            "part_id": 1,
            "title": "Correctness",
            "description": "<p>A solution should be considered correct even if it would earn 5+/7 points in a full grading. Examples of small penalties worth 1 point are if the solution: <ul><li>Makes a small computational mistake that can be easily fixed</li><li>Misses an edge case which can be easily proven/disproven</li><li>Skips over a step that follows without much reasoning or manual work</li></ul> A solution should be marked as incorrect if: <ul><li>It marks a step as trivial, if it is not immediately obvious why this would be the case</li><li>It omits algebra-heavy computational steps, regardless of whether or not it has outlined the methodology</li><li>Generalizes over a pattern without rigorously describing the pattern, or without proving any relevant properties.</li><li>It cites a non-existing or unpopular source/Theorem, which cannot be immediately found from searching for it online. Thus, any theorems that can be immediately found and have a Wikipedia article are allowed.</li></ul> The model has been specifically told that it should not skip steps or mark them as trivial. Any violation of this rule should be considered by assuming the model does not know how to derive the &quot;trivial&quot; step</p>",
            "points": 1
        }
    ],
    "points": 1
}